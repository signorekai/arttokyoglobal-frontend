---
import Layout from "../../../../layouts/Layout.astro";
import collections, {
  collectionSlugsWithTokenSlugs,
} from "../../../../data/collections";

import _find from "lodash/find";
import ProjectStatus from "../../../../components/ProjectStatus.astro";

const { collectionSlug, tokenSlug } = Astro.params;
const collection = _find(collections, ["slug", collectionSlug]);
const token = _find(collection.tokens, ["slug", tokenSlug]);
const { artist } = collection;

export function getStaticPaths() {
  return collectionSlugsWithTokenSlugs;
}

token.attributes = [
  {
    id: "circle",
    label: "Circle",
    value: 22,
    count: 0.663,
  },
  {
    id: "square",
    label: "Square",
    value: 90,
    count: 0.00123,
  },
];
---

<Layout title={`${tokenSlug} of ${collection.title}`}>
  <div class="container">
    <div
      class="py-4 md:py-6 max-h-[80vh] w-full px-4 mx-auto flex flex-col items-center text-center justify-center"
    >
      <img
        src={token.src}
        class="lg:h-full"
        style={`aspect-ratio: ${token.width} / ${token.height}`}
        alt=""
      />
      <h5 class="mt-4">{token.title}</h5>
    </div>
  </div>
  <div class="container flex flex-col lg:flex-row px-4">
    <div
      class="w-full lg:flex-1 mt-4 lg:mt-0 px-2 lg:px-0 lg:pl-8 order-2 flex flex-col items-end"
    >
      <ProjectStatus status={collection.status} />
      <a
        href={`/collections/${collection.slug}`}
        class="text-right mt-4 w-full lg:ml-8 group"
      >
        <h1>{collection.title}</h1>
      </a>
      <div class="group">
        <div class="flex flex-row my-2 justify-end">
          <div class="text-right">
            <a href={`/artists/${artist.slug}`}>
              <h4>{artist.name}</h4>
            </a>
            <h4 class="font-normal group-hover:text-black transition-none">
              <strong>{collection.tokens.length}</strong>
              of <strong>{collection.totalTokens}</strong>
              minted
            </h4>
          </div>
          <a href={`/artists/${artist.slug}`}>
            <img
              src={collection.artist.profilePhoto}
              alt={collection.artist.name}
              class="aspect-square h-10 ml-3 mb-1 rounded-lg grayscale group-hover:grayscale-0 transition-all"
            />
          </a>
        </div>
      </div>
      <div class="text-right" set:html={collection.description}></div>
      <a
        href={`/collections/${collection.slug}`}
        class="btn btn--red btn--standard"
        ><h4>View Collection</h4>
      </a>
    </div>

    <div class="w-full lg:w-7/12 order-1">
      <div class="bg-peach rounded-4xl w-full px-4 py-6 md:py-8 md:px-6">
        <table class="features-table">
          <thead>
            <tr>
              <th><h5>Feature</h5></th>
              <th><h5>Value</h5></th>
              <th><h5>% | Rarity</h5></th>
            </tr>
          </thead>
          <tbody class="text-center font-trade-gothic text-sm">
            {
              token.attributes.map((attribute) => (
                <tr>
                  <td>{attribute.label}</td>
                  <td>{attribute.value}</td>
                  <td>{attribute.count * 100}%</td>
                </tr>
              ))
            }
          </tbody>
        </table>
      </div>
    </div>
  </div>
</Layout>
